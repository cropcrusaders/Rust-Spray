name: RustSpray CI

on:
  push:
  pull_request:
  workflow_dispatch:

permissions:
  contents: write
  pull-requests: write

jobs:
  sanity-check:
    name: 🚦 Sanity Check
    runs-on: ubuntu-latest
    steps:
      - name: Print trigger info
        run: |
          echo "✅ Workflow '${{ github.workflow }}' triggered by '${{ github.event_name }}' on ref '${{ github.ref }}'"

  host-build:
    name: 🖥️ x86_64: Build, Lint & Test
    needs: sanity-check
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Install host deps (demo)
        run: echo "Running host-build…"
      # → replace these echo steps with your real clippy/tests steps

  pi-build:
    name: 🐧 aarch64: Build for Raspberry Pi
    needs: sanity-check
    runs-on: ubuntu-latest
    container:
      image: ubuntu:22.04
      options: --platform=linux/arm64
    steps:
      - uses: actions/checkout@v4
      - name: Install Pi deps (demo)
        run: echo "Running pi-build…"
      # → replace this echo with your real ARM64 apt+cargo build
